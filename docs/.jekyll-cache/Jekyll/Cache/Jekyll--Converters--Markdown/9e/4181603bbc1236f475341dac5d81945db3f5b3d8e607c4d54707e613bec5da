I"’ş<p><span class="tag  is-primary ">
    Android
</span>
<span class="tag  is-primary ">
    Java
</span></p>

<h2 id="0-intro">0. Intro</h2>

<p>í•„ì íšŒì‚¬ì˜ ì¶”ë¡  ì„œë²„(Inference Server)ë¡œ ì´ë¯¸ì§€ë¥¼ <strong>POST</strong> ìš”ì²­í•´ì„œ ì‘ë‹µì„ ë°›ì•„ì˜¤ëŠ”
Android Applicationì„ ì œì‘í•˜ê²Œ ë˜ì—ˆë‹¤.</p>

<p>ë‚˜ëŠ” Android ê°œë°œì´ë€ ê±¸ ë‹¨ í•œë²ˆë„ í•´ë³¸ ì ì´ ì—†ì—ˆê³ ,
Java ë³´ë‹¤ëŠ” C++ì™€ Pythonì„ ì£¼ë¡œ ì¼ì—ˆë‹¤.</p>

<p>ê·¸ë˜ì„œ ê·¸ëŸ°ì§€ êµ‰ì¥íˆ ë§ì€ ì‚½ì§ˆì„ í•˜ë©° ì¥ì¥ 1ì£¼ì¼ì— ê±¸ì³ì„œ ê°œë°œì„ ì™„ë£Œí–ˆëŠ”ë°,
ë‚˜ì—ê²ŒëŠ” ë„ˆë¬´ ì–´ë µê³  ì¤‘ìš”í–ˆë˜ ì •ë³´ì˜€ê¸°ì— ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ í•˜ê²Œ ë˜ì—ˆë‹¤.</p>

<hr />

<h2 id="1-before-development">1. Before Development</h2>

<p>ìš°ì„ , ì–´ë– í•œ ì„œë²„ê°€ ìˆê³  ê±°ê¸°ì— AccessKeyì™€ Imageë¥¼ ë³´ë‚´ì•¼ í•œë‹¤.
ê°„ë‹¨í•˜ê²Œ Postman ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://velog.velcdn.com/cloudflare/bolero2/2d07c10a-cfd3-49b2-a8ea-251bfe794aa1/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202022-04-06%2006.04.20.png" alt="" /></p>

<p>ì´ë ‡ê²Œ POST methodë¡œ https://staging.server.com/api/inference/target ìœ„ì¹˜ë¡œ</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">accessKey</span> <span class="o">=</span> <span class="s">"abcd12345"</span>
<span class="n">files</span> <span class="o">=</span> <span class="s">"bird.jpg"</span>
</code></pre></div></div>
<p>í˜•ì‹ì„ ë³´ë‚´ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ë‹µì´ ì˜¨ë‹¤.</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"fileName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ì–´ì©Œêµ¬_ì €ì©Œêµ¬_íŒŒì¼ì´ë¦„1.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"width"</span><span class="p">:</span><span class="w"> </span><span class="mi">2560</span><span class="p">,</span><span class="w">
            </span><span class="nl">"height"</span><span class="p">:</span><span class="w"> </span><span class="mi">1696</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"outputs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"softmax"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9987636804580688</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"softmax"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0012363195419311523</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>ê°œë°œ ì „ì—, ì•Œì•„ì•¼ í•  ì •ë³´ëŠ”</p>
<blockquote>
  <ol>
    <li>ì–´ë–¤ Key ê°’ì„ ë³´ë‚´ì•¼ í•˜ëŠ”ê°€?</li>
    <li>ê°ê°ì˜ Keyì— ë§¤í•‘ë˜ëŠ” Value íƒ€ì…. (String? Image? Bitmap? ë“±)</li>
    <li>(ë‹¹ì—°í•˜ì§€ë§Œ) POST ìš”ì²­ì„ ë³´ë‚¼ ì„œë²„ ì£¼ì†Œ</li>
    <li>í—¤ë” ì •ë³´</li>
  </ol>
</blockquote>

<p>ë“±ì´ ìˆë‹¤.</p>

<p>í—¤ë” ì •ë³´ëŠ” Request ìš”ì²­ì„ ë³´ë‚¼ ë•Œ ì–´ê¸‹ë‚˜ê²Œ ë˜ë©´
<strong>1. ìš”ì²­ì´ ì˜ëª» ê°€ê±°ë‚˜</strong> í˜¹ì€ <strong>2. ì‘ë‹µì´ ì´ìƒí•˜ê²Œ ì˜¬ ìˆ˜ ìˆê¸°</strong> ë•Œë¬¸ì— ë°˜ë“œì‹œ í™•ì¸í•´ì•¼ í•œë‹¤.</p>

<p>ê·¸ëŸ¼ í—¤ë” ì •ë³´ëŠ” ì–´ë–»ê²Œ ì•Œ ìˆ˜ ìˆì„ê¹Œ?</p>

<hr />

<h2 id="2-checking-header-information">2. Checking header information</h2>

<p>ì‚¬ì‹¤ ì½”ë“œ ì‘ì„±ë³´ë‹¤ í—¤ë” í™•ì¸ì´ë¼ëŠ” ë¶€ë¶„ì´ ì—„ì²­ í˜ë“¤ì—ˆë‹¤.
ë‚˜ëŠ” ë„¤íŠ¸ì›Œí¬ë‚˜ ì„œë²„ ê°œë°œì„ í•´ ë³¸ ì ì´ ì—†ì–´ì„œ, í—¤ë”ì˜ ì¤‘ìš”ì„±ì„ ëª°ëëŠ”ë° ì´ë²ˆ ê¸°íšŒì— ë¼ˆì €ë¦¬ê²Œ ëŠê¼ˆë‹¤.</p>

<p>Swagger ë¼ë“ ì§€, DevTools(ê°œë°œì ë„êµ¬, ìš”ì†Œ ì ê²€) ë¼ë“ ì§€, ì–´ë– í•œ ë°©ì‹ìœ¼ë¡œë“  ì›¹í˜ì´ì§€ì—ì„œ í—¤ë” ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
í•„ìëŠ” ê°œë°œì ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì„œ ì›¹í˜ì´ì§€ì—ì„œ ì§ì ‘ í—¤ë”ë¥¼ í™•ì¸í•˜ì˜€ë‹¤.</p>

<p><img src="https://velog.velcdn.com/cloudflare/bolero2/bd9a5013-08e5-4cf4-bb94-54a8d05c391e/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202022-04-06%2006.18.57.png" alt="íšŒì‚¬ ì œí’ˆ.jpg" /></p>

<p><strong>ì´ë ‡ê²Œ ê°œë°œì ë„êµ¬ë¥¼ ì—´ê³ , ë„¤íŠ¸ì›Œí¬ íƒ­ - XHR/Fetch í•­ëª©ìœ¼ë¡œ ë“¤ì–´ê°€ë©´ [ìš”ì²­, ì‘ë‹µ, ìš”ì²­ ë°ì´í„°] ë“±ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</strong>
ê·¸ë¦¬ê³  ì €ê¸°ì˜ Content-Type, Accept-Language ë“±ì´ ìš°ë¦¬ê°€ Connectionì„ í•  ë•Œ ì„¤ì •í•´ì•¼ í•  í—¤ë” ë° Key ì •ë³´ë“¤ì´ë‹¤.</p>

<p>ì•„ë˜ë¡œ ë” ë‚´ë¦¬ë©´ ìš”ì²­ ë°ì´í„° í•­ëª©ì´ ìˆë‹¤.
<img src="https://velog.velcdn.com/cloudflare/bolero2/1b1a7fd0-d4ee-4fe7-9e5d-fb74af163c35/image.png" alt="" /></p>

<p>ìœ í˜•ì€ <code class="language-plaintext highlighter-rouge">multipart/form-data</code> ì´ê³ , boundaryëŠ” <code class="language-plaintext highlighter-rouge">----WebKitFormBoundaryAYuewg7muT6zRKkc</code> ì´ë‹¤.</p>

<p>ë‚˜ëŠ” boundaryê°€ ë­”ì§€ ì—„ì²­ í—·ê°ˆë ¸ëŠ”ë°, ì‰½ê²Œ ìƒê°í•´ì„œ â€œêµ¬ë¶„ìâ€ ë¼ê³  ë³´ë©´ ëœë‹¤.</p>

<p>POSTë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ë©´, key-value pairê°€ 1ê°œë“  10ê°œë“  í•˜ë‚˜ì˜ String íƒ€ì…ìœ¼ë¡œ ë³´ë‚¸ë‹¤.
ê·¸ëŸ¬ë©´ ê° key-value pairë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆì–´ì•¼ í•˜ëŠ”ë°, boundaryê°€ ê·¸ ì—­í• ì„ í•˜ê²Œ ëœë‹¤.</p>

<p>ê°œë°œì ë„êµ¬ì—ì„œ ìš”ì²­ ë°ì´í„°ë¥¼ ì§ì ‘ ë³¼ ìˆ˜ ìˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>------WebKitFormBoundaryAYuewg7muT6zRKkc
Content-Disposition: form-data; name="files"; filename="bird.jpg"
Content-Type: image/jpeg


------WebKitFormBoundaryAYuewg7muT6zRKkc--

</code></pre></div></div>
<p>ì´ë ‡ê²Œ, <strong>two-hypens</strong>(â€œâ€“â€œ)ê³¼ <strong>ì¤„ë°”ê¿ˆ</strong>(=crlf, Javaì—ì„œëŠ” â€œ\r\nâ€ì„ ì“´ë‹¤.), <strong>boundary</strong>ì˜ ì¡°í•©ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>1ê°œì˜ ë°ì´í„°ê°€ ì•„ë‹ˆë¼ ì—¬ëŸ¬ ê°œì˜ image dataë¥¼ ë³´ëƒˆì„ ë•Œì˜ ìš”ì²­ ë°ì´í„°ëŠ” ì–´ë–¨ê¹Œ?</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>------WebKitFormBoundary3d92ZiPrZIV3SDAy
Content-Disposition: form-data; name="files"; filename="bird1.jpg"
Content-Type: image/jpeg


------WebKitFormBoundary3d92ZiPrZIV3SDAy
Content-Disposition: form-data; name="files"; filename="cat1.jpg"
Content-Type: image/jpeg


------WebKitFormBoundary3d92ZiPrZIV3SDAy
Content-Disposition: form-data; name="files"; filename="deer1.jpg"
Content-Type: image/jpeg


------WebKitFormBoundary3d92ZiPrZIV3SDAy
Content-Disposition: form-data; name="files"; filename="dog1.jpg"
Content-Type: image/jpeg


------WebKitFormBoundary3d92ZiPrZIV3SDAy--

</code></pre></div></div>
<p>ì´ë ‡ê²Œ ë‚˜íƒ€ë‚œë‹¤. <strong>ìš°ë¦¬ê°€ Android ê°œë°œ ì‹œì— POST ë°ì´í„°ë¥¼ ë³´ë‚´ì¤„ ë•Œ, ì´ëŸ¬í•œ í˜•ì‹ì„ ë§ì¶°ì•¼ í•œë‹¤.</strong></p>

<p>(ë³´í†µ boundaryëŠ” ì›¹ í˜ì´ì§€ì—ì„œ ì•Œì•„ì„œ ë³´ë‚´ì¤€ë‹¤ê³  í•œë‹¤.
ê°œë°œìê°€ ì„ì˜ë¡œ ì‘ì„±í•´ë„ ëœë‹¤ê³  í•˜ì§€ë§Œ, í•„ìëŠ” ì›¹í˜ì´ì§€ì˜ í˜•ì‹ì„ ë³µì‚¬ ë¶™ì—¬ë„£ê¸° í•˜ì˜€ë‹¤.)</p>

<hr />

<h2 id="3-development">3. Development</h2>

<p>ì´ì œ ì‹¤ì œ ì½”ë“œë¶€ë¶„ì„ ì‘ì„±í•´ë³´ì.</p>

<h3 id="3-1-pre-setting">3-1. pre-setting</h3>
<p>ì‘ë™ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:</p>

<ol>
  <li>Load Image ë²„íŠ¼ìœ¼ë¡œ ImageViewì— ì´ë¯¸ì§€ë¥¼ ë„ìš°ê³ </li>
  <li>Send To Server ë²„íŠ¼ìœ¼ë¡œ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•œë‹¤.</li>
</ol>

<p>í™”ë©´ êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:
<img src="https://velog.velcdn.com/cloudflare/bolero2/03bd1748-a0df-43a5-907c-393a27385be9/flow1.jpg" alt="" /></p>

<p>ë²„íŠ¼ ë° String, ImageView, TextView ê´€ë ¨í•´ì„œëŠ” ì´í›„ì— í¬ìŠ¤íŒ…ì„ í•˜ê³ ,
ì§€ê¸ˆì€ Http Requestê°€ ëª©ì ì´ë¯€ë¡œ ìƒëµí•œë‹¤.</p>

<p>ìš°ì„ , STORAGE ë° Network permissionì„ ì ì–´ì¤˜ì•¼ í•œë‹¤.
<code class="language-plaintext highlighter-rouge">app/manifests/AndroidManifest.xml</code> ìœ„ì¹˜ì— ì ëŠ”ë‹¤.</p>

<ul>
  <li><strong>AndroidManifest.xml</strong>
```xml</li>
</ul>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.example.demoandroidapp">
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.INTERNET" />
</manifest>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ì™¸ë¶€ ClassëŠ” ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì—†ê¸° ë•Œë¬¸ì—, `build.gradle` ì—ëŠ” ìˆ˜ì •í•  ê²ƒì´ ì—†ë‹¤.

### 3-2. MainActivity

ê°„ë‹¨í•˜ê²Œ MainActivityì˜ OnCreate ë° OnCreate í•˜ìœ„ buttonLoadImage.setOnClickListener í•¨ìˆ˜ ì½”ë“œë§Œ ë³´ì.

- **MainActivity.class**
```java
import androidx.appcompat.app.AppCompatActivity;
import android.annotation.SuppressLint;
import android.content.Intent;
import android.database.Cursor;
import android.os.AsyncTask;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.drawable.BitmapDrawable;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;
import java.io.ByteArrayOutputStream;
import org.json.JSONArray;
import org.json.JSONObject;

public class MainActivity extends AppCompatActivity {
    private static final int RESULT_LOAD_IMAGE = 1;
    private static String output = "";
    private TextView resultTextView = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // declaration button
        Button buttonLoadImage = (Button) findViewById(R.id.button);
        Button buttonSendToServer = (Button) findViewById(R.id.detect);
        resultTextView = findViewById(R.id.resultText);

        // permission
        requestPermissions(new String[]{android.Manifest.permission.READ_EXTERNAL_STORAGE}, 1);

        // Declaration TextView, ImageView, initialization resultTextView

        TextView NothingToShowTextView = findViewById(R.id.nothingToShowText);
        ImageView imageView = (ImageView) findViewById(R.id.image);
        resultTextView.setText("");

        buttonLoadImage.setOnClickListener(new View.OnClickListener() {

            @SuppressLint("SetTextI18n")
            @Override
            public void onClick(View arg0) {
                // reset TextView
                NothingToShowTextView.setText("");
                Intent i = new Intent(
                        Intent.ACTION_PICK,
                        MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
                startActivityForResult(i, RESULT_LOAD_IMAGE);
            }
        });
</code></pre></div></div>

<p>ê·¸ë¦¬ê³  OnCreate ë‚´ë¶€ì— ì´ì–´ì„œ <code class="language-plaintext highlighter-rouge">buttonSendToServer.setOnClickListener</code> ë¥¼ ì‘ì„±í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">buttonSendToServer</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>

    <span class="nd">@SuppressLint</span><span class="o">(</span><span class="s">"SetTextI18n"</span><span class="o">)</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">arg0</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Bitmap</span> <span class="n">original_bitmap</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

        <span class="nc">String</span> <span class="n">url_string</span> <span class="o">=</span> <span class="s">"https://staging.server.com/api/inference/target"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">accessKey_string</span> <span class="o">=</span> <span class="s">"abcd12345"</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">resultTextView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">"Inference in progress..."</span><span class="o">);</span>

            <span class="c1">// Getting the image from the image view</span>
            <span class="c1">// [1] Read the image as Bitmap</span>
            <span class="n">original_bitmap</span> <span class="o">=</span> <span class="o">((</span><span class="nc">BitmapDrawable</span><span class="o">)</span> <span class="n">imageView</span><span class="o">.</span><span class="na">getDrawable</span><span class="o">()).</span><span class="na">getBitmap</span><span class="o">();</span>

            <span class="nc">ByteArrayOutputStream</span> <span class="n">blob</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ByteArrayOutputStream</span><span class="o">();</span>
            <span class="n">original_bitmap</span><span class="o">.</span><span class="na">compress</span><span class="o">(</span><span class="nc">Bitmap</span><span class="o">.</span><span class="na">CompressFormat</span><span class="o">.</span><span class="na">JPEG</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="n">blob</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">imageBytes</span> <span class="o">=</span> <span class="n">blob</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">();</span>

            <span class="c1">// [2] http connection</span>
            <span class="nc">NetworkTask</span> <span class="n">networkTask</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NetworkTask</span><span class="o">(</span><span class="n">url_string</span><span class="o">,</span>
                                                      <span class="n">accessKey_string</span><span class="o">,</span>
                                                      <span class="n">imageBytes</span><span class="o">,</span>
                                                      <span class="n">resultTextView</span><span class="o">);</span>
            <span class="n">networkTask</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Failed to open image file."</span><span class="o">);</span>
            <span class="n">finish</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">imageView</span><span class="o">.</span><span class="na">setImageDrawable</span><span class="o">(</span><span class="k">new</span> <span class="nc">BitmapDrawable</span><span class="o">(</span><span class="n">getResources</span><span class="o">(),</span> <span class="n">original_bitmap</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">String url_string</code> ì—ëŠ” Postmanì—ì„œ ë´¤ë˜ <code class="language-plaintext highlighter-rouge">"https://staging.server.com/api/inference/target"</code> ì„ ì ê³ , 
<code class="language-plaintext highlighter-rouge">String accessKey_string</code> ì—ëŠ” <code class="language-plaintext highlighter-rouge">"abcd12345"</code> ë¥¼ ì ì–´ì¤€ë‹¤.</p>

<p>ì—¬ê¸°ì„œ í•µì‹¬ì€ 2ê°€ì§€ì´ë‹¤.</p>
<blockquote>
  <ol>
    <li>Bitmap íƒ€ì…ì˜ ì´ë¯¸ì§€ë¥¼ byte[] íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•œë‹¤.</li>
    <li>AsyncTask ë¥¼ ìƒì†ë°›ì€ NetworkTaskë¥¼ execute() í•œë‹¤.</li>
  </ol>
</blockquote>

<p>byte[] í˜•íƒœë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì€, <strong>ImageViewì—ì„œ ì´ë¯¸ì§€ë¥¼ ì½ì–´ì„œ(bitmap) &gt; toByteArray();ë¥¼ ì ìš©í•˜ëŠ” ê²ƒ</strong>ì´ë‹¤.</p>

<h3 id="3-3-networktask">3-3. NetworkTask</h3>

<p>NetworkTaskëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í–ˆë‹¤:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">NetworkTask</span> <span class="kd">extends</span> <span class="nc">AsyncTask</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">,</span> <span class="nc">Void</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="cm">/**
     * AsyncTask start
     *
     * (single Worker Thread)
     * 1. onPreExecuted()
     * 2. doInBackground()
     *      - publishProgress() -&gt; onProgressUpdate()
     *      - publishProgress() -&gt; onProgressUpdate()
     *      - ...
     * 3. onPostExecuted()
     *
     */</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">url</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">accessKey</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">values</span><span class="o">;</span>
    <span class="nd">@SuppressLint</span><span class="o">(</span><span class="s">"StaticFieldLeak"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">TextView</span> <span class="n">_resultView</span><span class="o">;</span>

    <span class="c1">// Constructor</span>
    <span class="kd">public</span> <span class="nf">NetworkTask</span><span class="o">(</span><span class="nc">String</span> <span class="n">url</span><span class="o">,</span> <span class="nc">String</span> <span class="n">accessKey</span><span class="o">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">values</span><span class="o">,</span> <span class="nc">TextView</span> <span class="n">resultView</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">accessKey</span> <span class="o">=</span> <span class="n">accessKey</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">_resultView</span> <span class="o">=</span> <span class="n">resultView</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="nc">Void</span><span class="o">...</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">result</span><span class="o">;</span> <span class="c1">// ìš”ì²­ ê²°ê³¼ë¥¼ ì €ì¥í•  ë³€ìˆ˜.</span>
        <span class="nc">RequestHttpsURLConnection</span> <span class="n">requestHttpsURLConnection</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RequestHttpsURLConnection</span><span class="o">();</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">requestHttpsURLConnection</span><span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">accessKey</span><span class="o">,</span> <span class="n">values</span><span class="o">);</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[doInBackground] output : "</span> <span class="o">+</span> <span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[doInBackground] output is null state."</span><span class="o">);</span>
            <span class="o">}</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@SuppressLint</span><span class="o">(</span><span class="s">"SetTextI18n"</span><span class="o">)</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="nc">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onPostExecute</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">outputs</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">image</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

        <span class="kt">double</span> <span class="n">maxSoftmax</span> <span class="o">=</span> <span class="mf">0.0</span><span class="no">F</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

        <span class="nc">String</span> <span class="n">labelName</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">JSONArray</span> <span class="n">jsonArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONArray</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>

                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">jsonArray</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="nc">JSONObject</span> <span class="n">tempJsonObject</span> <span class="o">=</span> <span class="n">jsonArray</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                    <span class="n">image</span> <span class="o">=</span> <span class="n">tempJsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"image"</span><span class="o">);</span>
                    <span class="n">outputs</span> <span class="o">=</span> <span class="n">tempJsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"outputs"</span><span class="o">);</span>

                    <span class="nc">JSONArray</span> <span class="n">jsonOutputsArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONArray</span><span class="o">(</span><span class="n">outputs</span><span class="o">);</span>

                    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">jsonOutputsArray</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                        <span class="nc">JSONObject</span> <span class="n">tempOutputsJsonObject</span> <span class="o">=</span> <span class="n">jsonOutputsArray</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="n">j</span><span class="o">);</span>
                        <span class="n">labelName</span> <span class="o">=</span> <span class="n">tempOutputsJsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"label"</span><span class="o">);</span>
                        <span class="kt">double</span> <span class="n">tempSoftmaxValue</span> <span class="o">=</span> <span class="n">tempOutputsJsonObject</span><span class="o">.</span><span class="na">getDouble</span><span class="o">(</span><span class="s">"softmax"</span><span class="o">);</span>

                        <span class="k">if</span> <span class="o">(</span><span class="n">maxSoftmax</span> <span class="o">&lt;</span> <span class="n">tempSoftmaxValue</span><span class="o">)</span> <span class="o">{</span>
                            <span class="n">maxSoftmax</span> <span class="o">=</span> <span class="n">tempSoftmaxValue</span><span class="o">;</span>
                            <span class="k">switch</span> <span class="o">(</span><span class="n">labelName</span><span class="o">)</span> <span class="o">{</span>
                                <span class="k">case</span> <span class="s">"0"</span><span class="o">:</span>
                                    <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"bird"</span><span class="o">;</span>
                                    <span class="k">break</span><span class="o">;</span>
                                <span class="k">case</span> <span class="s">"1"</span><span class="o">:</span>
                                    <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"cat"</span><span class="o">;</span>
                                    <span class="k">break</span><span class="o">;</span>
                                <span class="k">case</span> <span class="s">"2"</span><span class="o">:</span>
                                    <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"deer"</span><span class="o">;</span>
                                    <span class="k">break</span><span class="o">;</span>
                                <span class="k">case</span> <span class="s">"3"</span><span class="o">:</span>
                                    <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"dog"</span><span class="o">;</span>
                                    <span class="k">break</span><span class="o">;</span>
                                <span class="k">case</span> <span class="s">"4"</span><span class="o">:</span>
                                    <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"frog"</span><span class="o">;</span>
                                    <span class="k">break</span><span class="o">;</span>
                                <span class="k">case</span> <span class="s">"5"</span><span class="o">:</span>
                                    <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"horse"</span><span class="o">;</span>
                                    <span class="k">break</span><span class="o">;</span>
                            <span class="o">}</span>
                        <span class="o">}</span>

                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[onPostExecute] output is null state."</span><span class="o">);</span>
            <span class="o">}</span>

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="n">_resultView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">"Result : ["</span> <span class="o">+</span> <span class="n">maxLabelName</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>AsyncTaskëŠ” Http Connectionì„ ìœ„í•´ì„œ <strong>ë°˜ë“œì‹œ</strong> ìƒì†ë°›ì•„ì•¼ ëœë‹¤ê³  í•œë‹¤.
(Android ì‹¤í–‰ì˜ main threadì—ì„œ network connection ë™ì‘ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•œë‹¤.)</p>

<p>AsyncTaskì˜ ë™ì‘ ë°©ì‹ì€</p>
<blockquote>
  <ol>
    <li>AsyncTask start</li>
    <li><strong>onPreExecuted()</strong></li>
    <li><strong>doInBackground()</strong>
      <ul>
        <li>publishProgress() -&gt; onProgressUpdate()</li>
        <li>publishProgress() -&gt; onProgressUpdate()</li>
        <li>â€¦</li>
      </ul>
    </li>
    <li><strong>onPostExecuted()</strong></li>
  </ol>
</blockquote>

<p>ìˆœì„œì´ë‹¤.</p>

<p>doInBackground() ì´í›„ì— onPostExecuted() í•¨ìˆ˜ê°€ ìˆ˜í–‰ë˜ëŠ”ë°,</p>

<p>doInBackground í•¨ìˆ˜ì˜ return typeì´ <strong>String</strong> ì´ë¯€ë¡œ,
onPostExecuted() í•¨ìˆ˜ì˜ ì…ë ¥ íŒŒë¼ë¯¸í„°ì˜ type ì—­ì‹œ <strong>String</strong> ì´ ëœë‹¤.</p>

<p>doInBackground ì—ì„œ ì‹¤ì œ POST requestë¥¼ ë‚ ë¦¬ê³ , onPostExecuted ì—ì„œ POST response Stringì— ëŒ€í•œ í›„ì²˜ë¦¬ê°€ ì´ë£¨ì–´ì§„ë‹¤. (í™”ë©´ì— ê²°ê³¼ê°’ ë„ì›Œì£¼ê¸° ë“±)</p>

<p>ì‹¤ì œ ë™ì‘ì€ <strong>doInBackground()</strong> í•¨ìˆ˜ ë‚´ë¶€ ì¤‘ê°„ì˜</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RequestHttpsURLConnection</span> <span class="n">requestHttpsURLConnection</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RequestHttpsURLConnection</span><span class="o">();</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">requestHttpsURLConnection</span><span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">accessKey</span><span class="o">,</span> <span class="n">values</span><span class="o">);</span> <span class="c1">// í•´ë‹¹ URLë¡œ ë¶€í„° ê²°ê³¼ë¬¼ì„ ì–»ì–´ì˜¨ë‹¤.</span>
</code></pre></div></div>
<p>ë¶€ë¶„ì—ì„œ POST requestë¥¼ ë‚ ë¦¬ê²Œ ëœë‹¤.
ìƒì„±ì íŒŒë¼ë¯¸í„°ëŠ” ì—†ê³ , <code class="language-plaintext highlighter-rouge">request</code> í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ëŠ”:</p>
<blockquote>
  <ol>
    <li><strong>url</strong> : API Endpoint</li>
    <li><strong>accessKey</strong> : key[â€˜accessKeyâ€™]</li>
    <li><strong>values</strong> : key[â€˜filesâ€™] (byte[] type.)</li>
  </ol>
</blockquote>

<p>ì´ë ‡ê²Œ 3ê°œë¡œ ì„¤ì •í•˜ì˜€ë‹¤.</p>

<p>ê·¸ëŸ¬ë©´ ì´ì œ í•µì‹¬ ë¶€ë¶„ì¸ <code class="language-plaintext highlighter-rouge">RequestHttpsURLConnection</code> class ì½”ë“œë¥¼ ë³´ì.</p>

<h3 id="3-4-requesthttpsurlconnection">3-4. RequestHttpsURLConnection</h3>

<ul>
  <li><strong>RequestHttpsURLConnection.class ì „ì²´ ì½”ë“œ</strong>
```java
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.InputStream;
import java.io.BufferedInputStream;
import java.io.DataOutputStream;
import javax.net.ssl.HttpsURLConnection;
import java.net.URL;
import java.nio.charset.StandardCharsets;</li>
</ul>

<p>public class RequestHttpsURLConnection {
    String strResponse = null;
    public String request(String _url, String accessKey, byte[] imageBytes){</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    // HttpURLConnection ì°¸ì¡° ë³€ìˆ˜.
    HttpsURLConnection urlConn = null;

    try{
        String crlf = "\r\n";     // carriage return + line feed
        String twoHyphens = "--";
        String boundary = "----WebKitFormBoundarynuXSuFo6d9f2xtbb";

        URL url = new URL(_url);
        urlConn = (HttpsURLConnection) url.openConnection();

        // [2-1]. urlConn ì„¤ì •.
        urlConn.setRequestMethod("POST"); // URL ìš”ì²­ì— ëŒ€í•œ ë©”ì†Œë“œ ì„¤ì • : POST.
        urlConn.setRequestProperty("USER-AGENT", "Mozilla/5.0");
        urlConn.setRequestProperty("ACCEPT-LANGUAGE", "en-us,en;0.5");
        urlConn.setDoInput(true);
        urlConn.setDoOutput(true);
        urlConn.setUseCaches(false);

        urlConn.setRequestProperty("Connection", "keep-alive");
        urlConn.setRequestProperty("User-Agent", "CodeJava Agent");
        urlConn.setRequestProperty("Content-Type", "multipart/form-data; boundary=" + boundary);

        // [2-2]. parameter ì „ë‹¬ ë° ë°ì´í„° ì½ì–´ì˜¤ê¸°.
        DataOutputStream request = new DataOutputStream(urlConn.getOutputStream());

        // Write key and values
        // 1. Access Key
        request.writeBytes(twoHyphens + boundary + crlf);
        request.writeBytes("Content-Disposition: form-data; name=\"accessKey\"" + crlf);
        request.writeBytes("Content-Type: application/json" + crlf);
        request.writeBytes(crlf);
        request.writeBytes(accessKey + crlf);

        // 2. Image data
        request.writeBytes(twoHyphens + boundary + crlf);
        request.writeBytes("Content-Disposition: form-data; name=\"files\"; filename=\"elephants1.png\"" + crlf);
        request.writeBytes("Content-Type: image/jpeg" + crlf);
        request.writeBytes(crlf);
        request.write(imageBytes);

        request.writeBytes(crlf);
        request.writeBytes(twoHyphens + boundary + twoHyphens + crlf);
        request.flush();
        request.close();

        int response_code = urlConn.getResponseCode();
        System.out.println("Connection response code : [" + response_code + "]");

        // [2-3]. ì—°ê²° ìš”ì²­ í™•ì¸.
        // ì‹¤íŒ¨ ì‹œ nullì„ ë¦¬í„´í•˜ê³  ë©”ì„œë“œë¥¼ ì¢…ë£Œ.
        if (response_code != HttpsURLConnection.HTTP_OK){
            return "Response Code : " + Integer.toString(response_code);	// response 200
        } else {
            InputStream responseStream = new BufferedInputStream(urlConn.getInputStream());
            BufferedReader responseStreamReader = new BufferedReader(new InputStreamReader(responseStream, StandardCharsets.UTF_8));

            String outputResponse = "";
            StringBuilder stringBuilder = new StringBuilder();

            while ((outputResponse = responseStreamReader.readLine()) != null) {
                stringBuilder.append(outputResponse).append("\n");
            }

            responseStreamReader.close();
            strResponse = stringBuilder.toString();

            return strResponse;
        }
    } catch (IOException e) {   // for URL.
        e.printStackTrace();
    }                           // for openConnection().
    finally {
        if (urlConn != null)
            urlConn.disconnect();
    }
    return null;
} } ```
</code></pre></div></div>

<p>ë‹¬ë‘ request í•¨ìˆ˜ í•˜ë‚˜ë§Œ êµ¬í˜„í•˜ì˜€ë‹¤. ì´ì œë¶€í„°ëŠ” ê° êµ¬ì„± ë³„ ì½”ë“œ ë¸”ëŸ­ì— ëŒ€í•œ ì„¤ëª…ê³¼ ì°¸ê³ ì‚¬í•­ë“¤ì´ë‹¤.</p>

<hr />

<p><em><strong>1. ìš°ë¦¬ê°€ ì•„ê¹Œ í—¤ë” ì •ë³´ ì°¾ê¸°ì—ì„œ ë´¤ì—ˆë˜ boundaryì™€, crlf(ì¤„ë°”ê¿ˆ), two-hypens ë³€ìˆ˜ë¥¼ í• ë‹¹í•œë‹¤.</strong></em></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">crlf</span> <span class="o">=</span> <span class="s">"\r\n"</span><span class="o">;</span>     <span class="c1">// carriage return + line feed</span>
<span class="nc">String</span> <span class="n">twoHyphens</span> <span class="o">=</span> <span class="s">"--"</span><span class="o">;</span>
<span class="nc">String</span> <span class="n">boundary</span> <span class="o">=</span> <span class="s">"----WebKitFormBoundarynuXSuFo6d9f2xtbb"</span><span class="o">;</span>
</code></pre></div></div>
<p>boundaryëŠ” ì„ì˜ë¡œ ì„¤ì • ê°€ëŠ¥í•˜ë‹¤ê³  í•˜ì§€ë§Œ, ì›¹ì•Œëª»ì¸ í•„ìëŠ” ì˜ ëª°ë¼ì„œ browserì—ì„œ ë³´ì—¬ì¤€ ê²ƒì„ ì¼ë‹¤.</p>

<hr />

<p><em><strong>2. URL ê°ì²´ë¥¼ ë§Œë“¤ê³ , Connectionì„ í™œì„±í™”í•œë‹¤.</strong></em></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="no">URL</span><span class="o">(</span><span class="n">_url</span><span class="o">);</span>
<span class="n">urlConn</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpsURLConnection</span><span class="o">)</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
</code></pre></div></div>

<hr />

<p><em><strong>3. í—¤ë” ì •ë³´ë¥¼ ì…ë ¥í•œë‹¤.</strong></em></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urlConn</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="s">"POST"</span><span class="o">);</span> <span class="c1">// URL ìš”ì²­ì— ëŒ€í•œ ë©”ì†Œë“œ ì„¤ì • : POST.</span>
<span class="n">urlConn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"USER-AGENT"</span><span class="o">,</span> <span class="s">"Mozilla/5.0"</span><span class="o">);</span>
<span class="n">urlConn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"ACCEPT-LANGUAGE"</span><span class="o">,</span> <span class="s">"en-us,en;0.5"</span><span class="o">);</span>
<span class="n">urlConn</span><span class="o">.</span><span class="na">setDoInput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
<span class="n">urlConn</span><span class="o">.</span><span class="na">setDoOutput</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
<span class="n">urlConn</span><span class="o">.</span><span class="na">setUseCaches</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

<span class="n">urlConn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Connection"</span><span class="o">,</span> <span class="s">"keep-alive"</span><span class="o">);</span>
<span class="n">urlConn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"User-Agent"</span><span class="o">,</span> <span class="s">"CodeJava Agent"</span><span class="o">);</span>
<span class="n">urlConn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"multipart/form-data; boundary="</span> <span class="o">+</span> <span class="n">boundary</span><span class="o">);</span>
</code></pre></div></div>
<p>ì´ì „ì— web-browserì—ì„œ ì‚´í´ ë³¸ í—¤ë” ì •ë³´ë“¤ì´ë‹¤. 
Content-Typeì€ <code class="language-plaintext highlighter-rouge">"multipart/form-data"</code> í˜•ì‹ì´ê³ , <code class="language-plaintext highlighter-rouge">;</code> ì´í›„ì— boundary ì •ë³´ë¥¼ ìœ„ì™€ ê°™ì´ ë„£ì–´ì£¼ë©´ ëœë‹¤.</p>

<p>ë˜í•œ, POST methodì´ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">urlConn.setRequestMethod()</code> ì˜ íŒŒë¼ë¯¸í„°ë¡œ _<strong>â€œPOSTâ€</strong>_ë¥¼ ë„£ì–´ì£¼ì—ˆë‹¤.</p>

<p>ì´ ì™¸ì—</p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">"USER-AGENT"</code> : web browserì—ì„œ í™•ì¸ ê°€ëŠ¥.
<code class="language-plaintext highlighter-rouge">"ACCEPT-LANGUAGE"</code> : <em><strong>â€œen-us,en;0.5â€</strong></em> ë¡œ ê³ ì •í•´ì¤¬ë‹¤.
<code class="language-plaintext highlighter-rouge">"Connection"</code> : web browserì—ì„œ í™•ì¸ ê°€ëŠ¥.
<code class="language-plaintext highlighter-rouge">"User-Agent"</code> : <em><strong>â€œCodeJava Agentâ€</strong></em> ë¡œ ê³ ì •í•´ì¤¬ë‹¤.</p>

  <p><code class="language-plaintext highlighter-rouge">urlConn.setDoInput(true)</code>
<code class="language-plaintext highlighter-rouge">urlConn.setDoOutput(true)</code>
<code class="language-plaintext highlighter-rouge">urlConn.setUseCaches(false)</code> : ìœ„ 3ê°œëŠ” true / true / false ë¡œ ê³ ì •í•´ì£¼ì—ˆë‹¤.</p>
</blockquote>

<p>ë“±ì„ ì ì–´ì¤€ë‹¤.</p>

<hr />

<p><em><strong>4. form-dataë¥¼ ì…ë ¥í•œë‹¤.</strong></em></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">DataOutputStream</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DataOutputStream</span><span class="o">(</span><span class="n">urlConn</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">());</span>

<span class="c1">// Write key and values</span>
<span class="c1">// 1. Access Key</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">twoHyphens</span> <span class="o">+</span> <span class="n">boundary</span> <span class="o">+</span> <span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="s">"Content-Disposition: form-data; name=\"accessKey\""</span> <span class="o">+</span> <span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="s">"Content-Type: application/json"</span> <span class="o">+</span> <span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">accessKey</span> <span class="o">+</span> <span class="n">crlf</span><span class="o">);</span>

<span class="c1">// 2. Image data</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">twoHyphens</span> <span class="o">+</span> <span class="n">boundary</span> <span class="o">+</span> <span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="s">"Content-Disposition: form-data; name=\"files\"; filename=\"anything.png\""</span> <span class="o">+</span> <span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="s">"Content-Type: image/jpeg"</span> <span class="o">+</span> <span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">imageBytes</span><span class="o">);</span>

<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">writeBytes</span><span class="o">(</span><span class="n">twoHyphens</span> <span class="o">+</span> <span class="n">boundary</span> <span class="o">+</span> <span class="n">twoHyphens</span> <span class="o">+</span> <span class="n">crlf</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</code></pre></div></div>

<p>ì‚¬ì‹¤ìƒ ì´ë²ˆ ê°œë°œì—ì„œ <strong>ê°€ì¥</strong> ì¤‘ìš”í•œ ë¶€ë¶„ì´ë‹¤.
ë‚˜ëŠ” ì´ëŸ° requestë¥¼ ì²˜ìŒë³´ë‚´ì„œ, 3ì¼ì„ í—¤ë§¸ì—ˆë‹¤.</p>

<p><strong>ì‹¤ì œ requestë¥¼ ë³´ë‚¼ ë°ì´í„°ë“¤ì˜ ëª…ì„¸ì„œ(?)ë¥¼ ì ì–´ì£¼ëŠ” ë¶€ë¶„ì´ë‹¤.</strong>
ì•„ê¹Œ ìš”ì²­ ë°ì´í„° í•­ëª©ì—ì„œ ë´¤ì—ˆë˜</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>------WebKitFormBoundaryAYuewg7muT6zRKkc (+ crlf)
Content-Disposition: form-data; name="files"; filename="bird.jpg" (+ crlf)
Content-Type: image/jpeg (+ crlf)
(+ crlf)
(+ crlf)
------WebKitFormBoundaryAYuewg7muT6zRKkc-- (+ crlf)
(+ crlf)
</code></pre></div></div>
<p>ì´ ë¶€ë¶„ì„ ì ì–´ì£¼ëŠ” ê²ƒì´ë‹¤.</p>

<ul>
  <li>í•­ìƒ ì‹œì‘ì€ twoHypens + boundary + crlfë¡œ ì‹œì‘í•œë‹¤.</li>
  <li>Content-Disposition ì„ ì ì–´ì¤€ë‹¤. ë¬¸ìì—´ì´ë¯€ë¡œ ì›¹í˜ì´ì§€ì—ì„œ ë³´ì´ëŠ” ê·¸ëŒ€ë¡œ ì ì–´ì£¼ë©´ ëœë‹¤. <strong>crlf ë¥¼ ë¶™ì¸ë‹¤.</strong></li>
  <li>Content-Type ì„ ì ì–´ì¤€ë‹¤. <strong>crlf ë¥¼ ë¶™ì¸ë‹¤.</strong></li>
  <li><strong>crlf ë¥¼ ë¶™ì¸ë‹¤.</strong></li>
  <li><em>ì‹¤ì œë¡œ ë³´ë‚¼(POST) ë°ì´í„°ë¥¼ ì ì–´ì¤€ë‹¤.</em>
    <ul>
      <li><strong>String ì¼ ê²½ìš°</strong> : request.writeBytes()</li>
      <li><strong>byte[] (image)ì¼ ê²½ìš°</strong> : request.write()</li>
    </ul>
  </li>
  <li><strong>crlf ë¥¼ ë¶™ì¸ë‹¤.</strong></li>
  <li>í•­ìƒ ë§ˆì§€ë§‰ì€ twoHypens + boundary + twoHypens + crlf ë¡œ ë§ˆë¬´ë¦¬í•œë‹¤.</li>
  <li>ë” ì´ìƒ ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ : <code class="language-plaintext highlighter-rouge">request.flush()</code> ë° <code class="language-plaintext highlighter-rouge">request.close()</code> ë¡œ POSTë¥¼ ì¢…ë£Œí•œë‹¤.</li>
</ul>

<p>ì´ë ‡ê²Œ í•˜ë©´ ì‹¤ì œ API Endpoint ì„œë²„ì— POST ë™ì‘ì´ ìˆ˜í–‰ëœë‹¤.</p>

<hr />

<p><em><strong>5. ì‘ë‹µ ì½”ë“œ(Response Code) ë° ì‘ë‹µ ë¬¸ìì—´ì„ í™•ì¸í•œë‹¤.</strong></em></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">response_code</span> <span class="o">=</span> <span class="n">urlConn</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Connection response code : ["</span> <span class="o">+</span> <span class="n">response_code</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">);</span>

<span class="c1">// [2-3]. ì—°ê²° ìš”ì²­ í™•ì¸.</span>
<span class="k">if</span> <span class="o">(</span><span class="n">response_code</span> <span class="o">!=</span> <span class="nc">HttpsURLConnection</span><span class="o">.</span><span class="na">HTTP_OK</span><span class="o">){</span>
    <span class="k">return</span> <span class="s">"Response Code : "</span> <span class="o">+</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">response_code</span><span class="o">);</span>	<span class="c1">// response 200</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
    <span class="nc">InputStream</span> <span class="n">responseStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedInputStream</span><span class="o">(</span><span class="n">urlConn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
    <span class="nc">BufferedReader</span> <span class="n">responseStreamReader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">InputStreamReader</span><span class="o">(</span><span class="n">responseStream</span><span class="o">,</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>

    <span class="nc">String</span> <span class="n">outputResponse</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="nc">StringBuilder</span> <span class="n">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>

    <span class="k">while</span> <span class="o">((</span><span class="n">outputResponse</span> <span class="o">=</span> <span class="n">responseStreamReader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">stringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">outputResponse</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">responseStreamReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="n">strResponse</span> <span class="o">=</span> <span class="n">stringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>

    <span class="k">return</span> <span class="n">strResponse</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì‘ë‹µì€ <code class="language-plaintext highlighter-rouge">InputStream</code> ê³¼ <code class="language-plaintext highlighter-rouge">BufferedReader</code> í´ë˜ìŠ¤ì—ì„œ ìˆ˜í–‰í•œë‹¤.
<code class="language-plaintext highlighter-rouge">BufferedReader</code> í´ë˜ìŠ¤ì˜ ê°ì²´ê°€ <code class="language-plaintext highlighter-rouge">InputStream</code> í´ë˜ìŠ¤ì˜ ê°ì²´ë¥¼ ë°›ëŠ”ë°, ì´ <code class="language-plaintext highlighter-rouge">InputStream</code> ì˜ ê°ì²´ëŠ” <code class="language-plaintext highlighter-rouge">urlConn.getInputStream()</code> ì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ”ë‹¤.</p>

<p>(ì‚¬ì‹¤ response ë¶€ë¶„ì€ ì•„ë§ˆ ì „ ì„¸ê³„ì˜ android http connection ëª¨ë“  ì½”ë“œì—ì„œ ë™ì¼í•˜ê²Œ ì ìš©ë  ê²ƒì´ë‹¤.)</p>

<p>ì´ë ‡ê²Œ í•´ì„œ, endlineê¹Œì§€ whileë¬¸ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">readline()</code> ì„ ìˆ˜í–‰í•˜ì—¬ <code class="language-plaintext highlighter-rouge">StringBuilder</code> ê°ì²´ì— ê²°ê³¼ ë¬¸ìì—´ì„ ì €ì¥í•œë‹¤.</p>

<p>ì´ë ‡ê²Œ ë‚˜ì˜¨ response ë¬¸ìì—´ì€, ì•„ê¹Œ <strong>MainActivity.class</strong> ì†ŒìŠ¤ ì½”ë“œì˜ NetworkTask í´ë˜ìŠ¤ ë‚´ë¶€
<code class="language-plaintext highlighter-rouge">result = requestHttpsURLConnection.request(url, accessKey, values);</code>
result ë³€ìˆ˜ì— ì €ì¥ëœë‹¤.</p>

<hr />

<h2 id="4-finish">4. Finish</h2>

<p>ê±°ì˜ ë‹¤ ì™”ë‹¤.</p>

<p>ì±•í„° 3ì˜ <code class="language-plaintext highlighter-rouge">request</code> í•¨ìˆ˜ëŠ” <code class="language-plaintext highlighter-rouge">doInBackground</code>ì—ì„œ ìˆ˜í–‰ë˜ì—ˆê³ ,
request ì˜ ê²°ê³¼ëŠ” <code class="language-plaintext highlighter-rouge">doInBackground</code> í•¨ìˆ˜ ë‚´ë¶€ì˜ <code class="language-plaintext highlighter-rouge">result</code> ë³€ìˆ˜ì— ì €ì¥ë˜ì—ˆìœ¼ë©°,
í•´ë‹¹ <code class="language-plaintext highlighter-rouge">result</code> ë³€ìˆ˜ë¥¼ return í•˜ë©´ <code class="language-plaintext highlighter-rouge">onPostExecuted</code> í•¨ìˆ˜ì—ì„œ result ë³€ìˆ˜ì˜ ê°’ì„ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤.
(ì´ê±´ ì •í•´ì§„ êµ¬ì¡°ì´ë‹¤.)</p>

<p>ê·¸ëŸ¬ë©´ ì´ì œ <code class="language-plaintext highlighter-rouge">onPostExecuted()</code> í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ ì‚´í´ë³´ì.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="nc">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onPostExecute</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
    <span class="nc">String</span> <span class="n">outputs</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">image</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

    <span class="kt">double</span> <span class="n">maxSoftmax</span> <span class="o">=</span> <span class="mf">0.0</span><span class="no">F</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

    <span class="nc">String</span> <span class="n">labelName</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>

    <span class="k">try</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">JSONArray</span> <span class="n">jsonArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONArray</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>

            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">jsonArray</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="nc">JSONObject</span> <span class="n">tempJsonObject</span> <span class="o">=</span> <span class="n">jsonArray</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                <span class="n">image</span> <span class="o">=</span> <span class="n">tempJsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"image"</span><span class="o">);</span>
                <span class="n">outputs</span> <span class="o">=</span> <span class="n">tempJsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"outputs"</span><span class="o">);</span>

                <span class="nc">JSONArray</span> <span class="n">jsonOutputsArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONArray</span><span class="o">(</span><span class="n">outputs</span><span class="o">);</span>

                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">jsonOutputsArray</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">j</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="nc">JSONObject</span> <span class="n">tempOutputsJsonObject</span> <span class="o">=</span> <span class="n">jsonOutputsArray</span><span class="o">.</span><span class="na">getJSONObject</span><span class="o">(</span><span class="n">j</span><span class="o">);</span>
                    <span class="n">labelName</span> <span class="o">=</span> <span class="n">tempOutputsJsonObject</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"label"</span><span class="o">);</span>
                    <span class="kt">double</span> <span class="n">tempSoftmaxValue</span> <span class="o">=</span> <span class="n">tempOutputsJsonObject</span><span class="o">.</span><span class="na">getDouble</span><span class="o">(</span><span class="s">"softmax"</span><span class="o">);</span>

                    <span class="k">if</span> <span class="o">(</span><span class="n">maxSoftmax</span> <span class="o">&lt;</span> <span class="n">tempSoftmaxValue</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">maxSoftmax</span> <span class="o">=</span> <span class="n">tempSoftmaxValue</span><span class="o">;</span>
                        <span class="k">switch</span> <span class="o">(</span><span class="n">labelName</span><span class="o">)</span> <span class="o">{</span>
                            <span class="k">case</span> <span class="s">"0"</span><span class="o">:</span>
                                <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"bird"</span><span class="o">;</span>
                                <span class="k">break</span><span class="o">;</span>
                            <span class="k">case</span> <span class="s">"1"</span><span class="o">:</span>
                                <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"cat"</span><span class="o">;</span>
                                <span class="k">break</span><span class="o">;</span>
                            <span class="k">case</span> <span class="s">"2"</span><span class="o">:</span>
                                <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"deer"</span><span class="o">;</span>
                                <span class="k">break</span><span class="o">;</span>
                            <span class="k">case</span> <span class="s">"3"</span><span class="o">:</span>
                                <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"dog"</span><span class="o">;</span>
                                <span class="k">break</span><span class="o">;</span>
                            <span class="k">case</span> <span class="s">"4"</span><span class="o">:</span>
                                <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"frog"</span><span class="o">;</span>
                                <span class="k">break</span><span class="o">;</span>
                            <span class="k">case</span> <span class="s">"5"</span><span class="o">:</span>
                                <span class="n">maxLabelName</span> <span class="o">=</span> <span class="s">"horse"</span><span class="o">;</span>
                                <span class="k">break</span><span class="o">;</span>
                        <span class="o">}</span>
                    <span class="o">}</span>

                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"[onPostExecute] output is null state."</span><span class="o">);</span>
        <span class="o">}</span>

    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="n">_resultView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">"Result : ["</span> <span class="o">+</span> <span class="n">maxLabelName</span> <span class="o">+</span> <span class="s">"]"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ìš°ë¦¬ëŠ” ë§¨ ì²˜ìŒì— Postman ìœ¼ë¡œ í™•ì¸í–ˆì„ ë•Œ, json í˜•íƒœì˜ ì‘ë‹µì´ ì˜¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
ê·¸ë ‡ê¸° ë•Œë¬¸ì— androidì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ JSON classë¥¼ import í•˜ì—¬ íŒŒì‹±í•˜ì˜€ë‹¤.</p>

<p>[ ] ë¡œ ì‹œì‘í•˜ë©´ JSONArrayë¡œ ê°ì²´ë¥¼ ë§Œë“¤ê³ , { } ë¡œ ì‹œì‘í•˜ë©´ JSONObjectë¡œ ê°ì²´ë¥¼ ë§Œë“¤ë©´ ëœë‹¤.</p>

<p>ì´ë ‡ê²Œ íŒŒì‹±ì„ í•˜ê³  ë‚˜ì„œ, TextView ì— ì¶”ë¡  ê²°ê³¼ categoryë¥¼ ì ì–´ì£¼ë©´ ê°œë°œì´ ëë‚˜ê²Œ ëœë‹¤.</p>

<hr />

<blockquote>
  <ul>
    <li>
      <p><strong>ë²„ê·¸ 1</strong> : AsyncTaskë¡œ ìˆ˜í–‰í•˜ì§€ ì•Šìœ¼ë©´, Android main threadì—ì„œ ìì²´ì ìœ¼ë¡œ blockingì„ í•œë‹¤.</p>
    </li>
    <li>
      <p><strong>ë²„ê·¸ 2</strong> : í—¤ë”ë¥¼ ì˜ëª» ì ìœ¼ë©´, response string ì´ ì „ë¶€ ê¹¨ì ¸ì„œ ì˜¬ ìˆ˜ ìˆë‹¤. ì´ëŸ´ ê²½ìš° 
<strong>í—¤ë”ë¥¼ í•˜ë‚˜ì”© ì†Œê±°í•˜ë©° ì–´ë–¤ í—¤ë”ë¥¼ ì˜ëª» ì ì—ˆëŠ”ì§€ ì²´í¬í•˜ê³ , í•´ë‹¹ í—¤ë”ì˜ ì˜¬ë°”ë¥¸ ê°’ì„ ì°¾ê±°ë‚˜ í˜¹ì€ ì•ˆì¨ì¤˜ë„ ë  ê²½ìš° ê·¸ëƒ¥ ì“°ì§€ë§ìâ€¦</strong></p>
    </li>
    <li><strong>ì°¸ê³  1</strong> : ë‚˜ì˜ ê²½ìš°ì—ì„œëŠ” AccessKeyë¥¼ ë„£ì–´ì£¼ê¸° ë•Œë¬¸ì— Https ì„œë²„ì—¬ë„ POSTê°€ ê°€ëŠ¥í–ˆë‹¤. (ë³„ë„ ì¸ì¦ì´ í•„ìš”ì—†ìŒ.) 
HTTP í†µì‹ ì˜ ê²½ìš° í¬ìŠ¤íŒ…í•œ ê²ƒì²˜ëŸ¼ í•˜ë©´ ëœë‹¤. ë‹¨, í´ë˜ìŠ¤ importëŠ” 
<code class="language-plaintext highlighter-rouge">import javax.net.ssl.HttpsURLConnection;</code> ëŒ€ì‹  <code class="language-plaintext highlighter-rouge">import java.net.HttpURLConnection;</code> ì„ ì¨ì£¼ê³ 
      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HttpURLConnection urlConn = null;
urlConn = (HttpURLConnection) url.openConnection();
</code></pre></div>      </div>
      <p>ìœ¼ë¡œ ë°”ê¿”ì£¼ì.</p>
    </li>
    <li>
      <p><strong>ì°¸ê³  2</strong> : Httpsì˜ ê²½ìš° CA(ì¸ì¦ì„œ)ì™€ ê°™ì€ ì¸ì¦ ì •ë³´ê°€ ë³„ë„ë¡œ í•„ìš”í•˜ë‹¤ê³  í•œë‹¤.</p>
    </li>
    <li>
      <p><strong>ì°¸ê³  3</strong> : AsyncTaskëŠ” ë°˜ë“œì‹œ ìƒì†ë°›ì•„ì•¼ í•œë‹¤.</p>
    </li>
    <li><strong>ì°¸ê³  4</strong> : POSTê°€ ì œëŒ€ë¡œ ì´ë£¨ì–´ì§€ì§€ ì•Šì•˜ì„ ê²½ìš°(response 400 codeì²˜ëŸ¼) web browser í˜¹ì€ API ë¬¸ì„œë¥¼ ë³´ê³ , ì–´ë–¤ í˜•íƒœì¸ì§€, Content-Type, Content-Disposition ë“±ì„ <strong>ë°˜ë“œì‹œ</strong> í™•ì¸í•˜ì.</li>
  </ul>
</blockquote>

:ET